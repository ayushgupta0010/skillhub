"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[336],{51042:function(We,Q,d){var J=d(1413),X=d(67294),ee=d(42110),le=d(84089),te=function(w,ne){return X.createElement(le.Z,(0,J.Z)((0,J.Z)({},w),{},{ref:ne,icon:ee.Z}))},B=X.forwardRef(te);Q.Z=B},88138:function(We,Q,d){d.r(Q);var J=d(97857),X=d.n(J),ee=d(64599),le=d.n(ee),te=d(15009),B=d.n(te),fe=d(99289),w=d.n(fe),ne=d(5574),U=d.n(ne),$e=d(51042),Ne=d(2618),Ze=d(90930),ye=d(27181),Y=d(76772),ze=d(53025),Ve=d(83622),E=d(67294),He=d(82254),we=d(66327),xe=d(96486),P=d.n(xe),ce=d(47221),I=d(87200),$=d(85893),Ge=ce.Z.Panel,ae=function(A,h,x){var M=typeof h=="string"?h:(A.match(new RegExp(h.source,"g"))||[]).slice(-1)[0];if(!M)return A;var N=A.lastIndexOf(M);return N!==-1?"".concat(A.slice(0,N)).concat(x).concat(A.slice(N+M.length)):A},Qe=function(){var A,h,x,M,N,C,ie,D,oe,O,se,F,de,R,re,L,ue,j,Xe=(0,Y.useModel)("@@initialState"),e=Xe.initialState,Z=(0,E.useRef)(),be=(0,E.useRef)(),k=(0,E.useRef)(),m=(0,Y.useParams)(),Ye=(0,E.useState)({}),Te=U()(Ye,2),c=Te[0],ke=Te[1],qe=(0,E.useState)([]),ge=U()(qe,2),el=ge[0],ll=ge[1],tl=(0,E.useState)(!1),Ee=U()(tl,2),nl=Ee[0],he=Ee[1],al=(0,E.useState)(),Me=U()(al,2),il=Me[0],Pe=Me[1],ol=(0,E.useState)({}),De=U()(ol,2),_e=De[0],Oe=De[1],sl=(0,E.useState)([]),Se=U()(sl,2),dl=Se[0],rl=Se[1],ul=(0,E.useState)({}),Ce=U()(ul,2),ve=Ce[0],_l=Ce[1],vl=(0,E.useState)({}),Fe=U()(vl,2),Re=Fe[0],pl=Fe[1],ml=(0,E.useState)(),Ue=U()(ml,2),fl=Ue[0],Ke=Ue[1],yl=(0,E.useState)(),Ie=U()(yl,2),pe=Ie[0],Ae=Ie[1],Le=(0,E.useRef)(),cl=(A=e==null||(h=e.settings)===null||h===void 0||(h=h.composite_tables)===null||h===void 0||(h=h[m.table])===null||h===void 0||(h=h.parent.create)===null||h===void 0?void 0:h.enable)!==null&&A!==void 0?A:!1,hl=(x=e==null||(M=e.settings)===null||M===void 0||(M=M.composite_tables)===null||M===void 0||(M=M[m.table])===null||M===void 0||(M=M.parent.update)===null||M===void 0?void 0:M.enable)!==null&&x!==void 0?x:!1,Ml=(N=e==null||(C=e.settings)===null||C===void 0||(C=C.composite_tables)===null||C===void 0||(C=C[m.table])===null||C===void 0||(C=C.parent.delete)===null||C===void 0?void 0:C.enable)!==null&&N!==void 0?N:!1,je=(ie=e==null||(D=e.settings)===null||D===void 0||(D=D.composite_tables)===null||D===void 0||(D=D[m.table])===null||D===void 0||(D=D.parent)===null||D===void 0||(D=D.table)===null||D===void 0?void 0:D.page_size)!==null&&ie!==void 0?ie:20,bl=(oe=e==null||(O=e.settings)===null||O===void 0||(O=O.composite_tables)===null||O===void 0||(O=O[m.table])===null||O===void 0||(O=O.parent)===null||O===void 0||(O=O.table)===null||O===void 0?void 0:O.table_size)!==null&&oe!==void 0?oe:"middle";(0,E.useEffect)(function(){var u=function(){var t=w()(B()().mark(function a(){var s,l,n,i,o,v,p,r;return B()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return o=(s=e==null||(l=e.settings)===null||l===void 0||(l=l.composite_tables)===null||l===void 0?void 0:l[m.table])!==null&&s!==void 0?s:{},v=o==null||(n=o.parent)===null||n===void 0?void 0:n.name,_.next=4,(0,I.st)(v);case 4:return p=_.sent,r=(i=p.primary_key)!==null&&i!==void 0?i:[],rl(r),pl(p.cols),_.next=10,(0,Y.request)("".concat("/api","/graphql"),{method:"POST",headers:(0,Ne.zl)(),data:{query:(0,He.K)(),variables:{}}});case 10:return _.abrupt("return",_.sent);case 11:case"end":return _.stop()}},a)}));return function(){return t.apply(this,arguments)}}();u().then(function(){var t=w()(B()().mark(function a(s){var l,n,i,o,v,p,r,f,_,y,K,b,W,T,z,S,V,q,H;return B()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:i=(0,we.Z)(s.data),o=i.getQueryType().getFields(),v={},p=(l=e==null||(n=e.settings)===null||n===void 0||(n=n.composite_tables)===null||n===void 0?void 0:n[m.table])!==null&&l!==void 0?l:{},r=le()(p.children),g.prev=5,r.s();case 7:if((f=r.n()).done){g.next=19;break}return T=f.value,z=(_=T.relation)!==null&&_!==void 0?_:"",S=o[e==null||(y=e.settings)===null||y===void 0||(y=y.composite_tables)===null||y===void 0||(y=y[m.table])===null||y===void 0||(y=y.parent)===null||y===void 0?void 0:y.name].type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields()[z].type,V=P().snakeCase((K=S.ofType)!==null&&K!==void 0&&K.getFields()?ae((b=S.ofType)===null||b===void 0?void 0:b.name,"Connection",""):S.name),g.next=14,(0,I.st)(V);case 14:q=g.sent,H=(W=q.primary_key)!==null&&W!==void 0?W:[],v[V]=H;case 17:g.next=7;break;case 19:g.next=24;break;case 21:g.prev=21,g.t0=g.catch(5),r.e(g.t0);case 24:return g.prev=24,r.f(),g.finish(24);case 27:_l(v),ke(o);case 29:case"end":return g.stop()}},a,null,[[5,21,24,27]])}));return function(a){return t.apply(this,arguments)}}())},[]),(0,E.useEffect)(function(){var u,t,a,s,l;if(!P().isEmpty(c)){var n=(u=e==null||(t=e.settings)===null||t===void 0||(t=t.composite_tables)===null||t===void 0?void 0:t[m.table])!==null&&u!==void 0?u:{},i=n==null||(a=n.parent)===null||a===void 0?void 0:a.name,o=(s=n==null?void 0:n.parent)!==null&&s!==void 0?s:{},v=c[i],p=v.name,r=v.type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields(),f=(0,I.SS)(o,p,r,Pe,Ke,Z,Re);ll(f),(l=Z.current)===null||l===void 0||l.reloadAndRest()}},[c]);var Tl=ze.Z.useForm(),gl=U()(Tl,1),Pl=gl[0];return(0,$.jsxs)(Ze._z,{header:{title:null,breadcrumb:{items:[{href:"#",title:"Composite Tables",onClick:function(){return Y.history.push("/composite-table")}},{title:(se=e==null||(F=e.settings)===null||F===void 0||(F=F.composite_tables)===null||F===void 0||(F=F[m.table])===null||F===void 0||(F=F.table)===null||F===void 0?void 0:F.title)!==null&&se!==void 0?se:P().startCase(m.table)}]}},children:[(0,$.jsx)(ye.Z,{headerTitle:(de=e==null||(R=e.settings)===null||R===void 0||(R=R.composite_tables)===null||R===void 0||(R=R[m.table])===null||R===void 0||(R=R.table)===null||R===void 0?void 0:R.title)!==null&&de!==void 0?de:P().startCase(m.table),actionRef:Z,request:function(){var u=w()(B()().mark(function t(a,s,l){var n,i,o,v,p,r,f,_,y,K,b,W,T;return B()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return r=(n=e==null||(i=e.settings)===null||i===void 0||(i=i.composite_tables)===null||i===void 0?void 0:i[m.table])!==null&&n!==void 0?n:{},f=r==null||(o=r.parent)===null||o===void 0?void 0:o.name,_=(v=r==null?void 0:r.parent)!==null&&v!==void 0?v:{},y=(p=r==null?void 0:r.children)!==null&&p!==void 0?p:[],K=c[f],b=K.name,W=K.type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields(),T=Object.values(c[b].args).find(function(V){return V.name=="filters"}),S.next=10,(0,I.pC)(a,s,l,_,b,W,T,y,Re);case 10:return S.abrupt("return",S.sent);case 11:case"end":return S.stop()}},t)}));return function(t,a,s){return u.apply(this,arguments)}}(),toolBarRender:function(){return[cl?(0,$.jsx)(Ve.ZP,{icon:(0,$.jsx)($e.Z,{}),onClick:function(){var a;he(!0),k==null||(a=k.current)===null||a===void 0||a.resetFields()},type:"primary",size:"small",children:"New"},"button"):null]},columns:el,expandable:{expandedRowRender:function(t,a,s,l){var n,i;return(0,$.jsx)(ce.Z,{children:((n=e==null||(i=e.settings)===null||i===void 0||(i=i.composite_tables)===null||i===void 0||(i=i[m.table])===null||i===void 0?void 0:i.children)!==null&&n!==void 0?n:[]).map(function(o){var v,p,r,f,_,y,K,b=(v=o.relation)!==null&&v!==void 0?v:"",W=(p=(r=c[e==null||(f=e.settings)===null||f===void 0||(f=f.composite_tables)===null||f===void 0||(f=f[m.table])===null||f===void 0||(f=f.parent)===null||f===void 0?void 0:f.name].type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields()[b].type.ofType)===null||r===void 0?void 0:r.getFields().nodes.type.ofType.ofType.ofType.getFields())!==null&&p!==void 0?p:c[e==null||(_=e.settings)===null||_===void 0||(_=_.composite_tables)===null||_===void 0||(_=_[m.table])===null||_===void 0||(_=_.parent)===null||_===void 0?void 0:_.name].type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields()[b].type.getFields();return(0,$.jsx)(Ge,{header:(y=o==null||(K=o.table)===null||K===void 0?void 0:K.title)!==null&&y!==void 0?y:P().startCase(b),children:(0,$.jsx)(ye.Z,{dataSource:P().isArray(t[b].nodes)?t[b].nodes:[t[b]],columns:function(T,z,S){if(!P().isEmpty(c)){var V=function(me){var G={};G[b]=me,Oe(G)},q=function(me){var G={};G[b]=me,Ae(G)},H=c[e==null||(T=e.settings)===null||T===void 0||(T=T.composite_tables)===null||T===void 0||(T=T[m.table])===null||T===void 0||(T=T.parent)===null||T===void 0?void 0:T.name].type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields()[b].type,Be=P().snakeCase((z=H.ofType)!==null&&z!==void 0&&z.getFields()?ae((S=H.ofType)===null||S===void 0?void 0:S.name,"Connection",""):H.name),g=X()({childNavBar:!0},o);return(0,I.SS)(g,Be,W,V,q,Z)}}(),headerTitle:!1,search:!1,options:!1,pagination:!1})},b)})},a)}},rowKey:"_uuid_v4_",dateFormatter:"string",toolbar:{multipleLine:!0},pagination:{pageSizeOptions:P().sortedUniq([10,20,50,100,je].sort(function(u,t){return u-t})),defaultPageSize:je},defaultSize:bl}),function(u,t,a,s){if(!P().isEmpty(c)){var l=(u=e==null||(t=e.settings)===null||t===void 0||(t=t.composite_tables)===null||t===void 0?void 0:t[m.table])!==null&&u!==void 0?u:{},n=l==null||(a=l.parent)===null||a===void 0?void 0:a.name,i=(s=l==null?void 0:l.parent)!==null&&s!==void 0?s:{},o=c[n],v=o.name,p=o.type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields();return(0,I.HF)(i,v,p,il,Pe,be,Z,dl)}}(),function(u,t,a,s){if(!P().isEmpty(c)){var l=(u=e==null||(t=e.settings)===null||t===void 0||(t=t.composite_tables)===null||t===void 0?void 0:t[m.table])!==null&&u!==void 0?u:{},n=l==null||(a=l.parent)===null||a===void 0?void 0:a.name,i=(s=l==null?void 0:l.parent)!==null&&s!==void 0?s:{},o=c[n],v=o.name,p=o.type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields();return(0,I.SI)(i,v,p,nl,he,k,Z)}}(),function(u,t,a,s){if(!P().isEmpty(c)){var l=(u=e==null||(t=e.settings)===null||t===void 0||(t=t.composite_tables)===null||t===void 0?void 0:t[m.table])!==null&&u!==void 0?u:{},n=l==null||(a=l.parent)===null||a===void 0?void 0:a.name,i=(s=l==null?void 0:l.parent)!==null&&s!==void 0?s:{},o=c[n],v=o.name,p=o.type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields();return(0,I.WM)(l,v,p,fl,Ke,Le)}}(),P().isEmpty(c)?null:((re=e==null||(L=e.settings)===null||L===void 0||(L=L.composite_tables)===null||L===void 0||(L=L[m.table])===null||L===void 0?void 0:L.children)!==null&&re!==void 0?re:[]).map(function(u){var t,a,s,l,n,i,o,v,p=(t=u.relation)!==null&&t!==void 0?t:"",r=c[e==null||(a=e.settings)===null||a===void 0||(a=a.composite_tables)===null||a===void 0||(a=a[m.table])===null||a===void 0||(a=a.parent)===null||a===void 0?void 0:a.name].type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields()[p].type,f=(s=(l=r.ofType)===null||l===void 0?void 0:l.getFields().nodes.type.ofType.ofType.ofType.getFields())!==null&&s!==void 0?s:r.getFields(),_=(n=_e==null?void 0:_e[p])!==null&&n!==void 0?n:void 0,y=P().snakeCase((i=r.ofType)!==null&&i!==void 0&&i.getFields()?ae((o=r.ofType)===null||o===void 0?void 0:o.name,"Connection",""):r.name);return(0,I.HF)(u,y,f,_,Oe,be,Z,(v=ve==null?void 0:ve[y])!==null&&v!==void 0?v:[])}),P().isEmpty(c)?null:((ue=e==null||(j=e.settings)===null||j===void 0||(j=j.composite_tables)===null||j===void 0||(j=j[m.table])===null||j===void 0?void 0:j.children)!==null&&ue!==void 0?ue:[]).map(function(u){var t,a,s,l,n,i,o=(t=u.relation)!==null&&t!==void 0?t:"",v=(a=(s=c[e==null||(l=e.settings)===null||l===void 0||(l=l.composite_tables)===null||l===void 0||(l=l[m.table])===null||l===void 0||(l=l.parent)===null||l===void 0?void 0:l.name].type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields()[o].type.ofType)===null||s===void 0?void 0:s.getFields().nodes.type.ofType.ofType.ofType.getFields())!==null&&a!==void 0?a:c[e==null||(n=e.settings)===null||n===void 0||(n=n.composite_tables)===null||n===void 0||(n=n[m.table])===null||n===void 0||(n=n.parent)===null||n===void 0?void 0:n.name].type.ofType.getFields().nodes.type.ofType.ofType.ofType.getFields()[o].type.getFields(),p=(i=pe==null?void 0:pe[o])!==null&&i!==void 0?i:void 0;return(0,I.WM)(u,o,v,p,Ae,Le)})]})};Q.default=Qe}}]);
